我已经有一段时间没有更新我的RTKLIB配置文件指南了。 自从上次更新以来，我增加了一些新的功能，并对一些现有的功能有了更多的了解。 对于以前的更新，我只是更新了原帖，但这次我想我应该重新发布它，使它更容易被找到。、

RTKLIB 的一大优点是它的可配置性极强，有一系列的输入选项。但选项多了也会让人难以上手，[RTKLIB 手册](https://www.rtklib.com/prog/manual_2.4.2.pdf)确实简要地解释了每个选项的作用，但即使有这些信息，也很难知道如何最好地选择一些参数的值。

在本篇博客，我不会对所有的输入选项进行全面的解释，但会解释我在实验中发现的那些有用的调整，以及原因。我描述的是它们在配置文件中出现的样子，而不是它们在RTKNAVI GUI菜单中出现的样子，但这些配置选项适用于两者。我通过比较我的最新配置文件和默认配置文件，并注意到哪些设置是不同的，从而创建了这个列表。下面列表中的数值是我在配置文件中为 5Hz 的接收机测量速率所使用的数值。 同样的配置文件可以用于 RTKNAVI、RTKPOST 或 RNX2RTKP。

我的大部分工作是针对使用 Ublox M8N 和 M8T 接收机短基线的 RTK 解决方案，这些设置将更直接地适用于这些组合，但至少应作为其他情况的一个起点。

### SETTING 1

**pos1-posmode = static, kinematic,** **static-start,** **movingbase, fixed** 

如果漫游器是静止的，使用 "static"。如果它是移动的，则使用 "kinematic "或 "static-start "。"static-start  "将假定漫游器是静止的，直到实现第一次固定，然后切换到动态模式，允许卡尔曼滤波利用漫游器最初不移动的知识。 如果基地和漫游器一样在移动，你可以使用 "movingbase "，但是除非基准站在长距离移动，否则不需要使用。 我经常发现，即使基准站在移动，"kinematic  "也比 "movingbase "提供更好的解决方案。 "movingbase  "模式与动力学模式不兼容，所以一定不要同时启用两者。 如果基地和漫游者保持固定的距离，在 "movingbase  "模式下设置 "pos2-baselen "和 "pos2-basig"。  如果你知道漫游器的确切位置，并且只对分析残差感兴趣，就使用 "fixed"。

**pos1-frequency = l1**

 "l1 "用于单频接收机，"l1+l2 "如果漫游器是双频GPS/GLONASS/Bediou，"l1+l2+e5b "如果包括伽利略E5b。 从dem05 b33代码开始，伽利略E5b被包括在 L2 解决方案中，所以 "l1+l2 "相当于 "l1+l2+e5b" 

**pos1-soltype = forward, backward, combined**

 这是卡尔曼滤波器运行的时间方向。对于实时处理，"forward"是你唯一的选择。对于后处理，"combined** "首先向前运行滤波器，然后向后运行并合并结果。对于每个纪元，如果两个方向都有一个固定值，那么合并后的结果就是两个固定状态的平均值，除非两者之间的差异太大，在这种情况下，状态将是浮动的。如果只有一个方向有一个固定值，那么这个值将被使用，状态将是固定的。如果两个方向都是浮动的，那么将使用平均值，状态将是浮动的。合并的结果并不总是更好，因为在任何一个方向上运行时，错误的固定值通常会导致合并的结果是浮动的和不正确的。合并的主要优点是，它通常会在数据开始时就给你固定的状态，而只有正向的解决方案将需要一些时间来收敛。2.4.3的代码总是在开始反向运行之前重置偏置状态，以确保独立的解决方案。如果含糊解决方法被设置为 "连续"，Demo5的代码不会重置偏置状态，以避免在漫游器移动时重新锁定，但如果被设置为 "固定和保持"，则会重置偏置。 我只在获得初始固定时遇到困难，想知道正确的卫星相位偏差时才使用 "backward"设置进行调试。

**pos1-elmask = 15 (degrees)**

用于计算位置的最小卫星高度。我通常将其设置为10-15度，以减少将多径带入解决方案的机会，但这个设置将取决于漫游器的环境。天空视野越开阔，这个值可以设置得越低。

**pos1-snrmask-r = off, pos1-snrmask-b = off,on**

 漫游器(r)和基地(b)的最小卫星信噪比，用于计算位置。这可能是一个比海拔更有效的消除不良卫星的标准，因为它是信号质量的一个更直接的衡量标准，但最佳值会随着接收器类型和天线类型的不同而不同，所以我在大多数时候都不使用它，以避免为每个应用调整它。

**pos1-snrmask_L1 =35,35,35,35,35,35,35,35,35**

 为每五度的海拔设置信噪比阈值。我通常让所有的值都一样，根据标称的信噪比是多少，选择35到38分贝之间的值。这些值只在pos1-snrmask_x设置为 on 时使用。 如果你使用的是双频，你还需要设置 "pos1-snrmask_L2"

**pos1-dynamics = on**

启用漫游器动力学会在漫游器的卡尔曼滤波中增加速度和加速度状态。它将改善 "kinematic "和 "static-start "的结果，但对 "static "模式几乎没有影响。在启用动力学的情况下，发布的代码将明显运行得更慢，但Demo5的代码应该是可以的。请确保根据你的漫游器加速特性适当地设置 "prnaccelh "和 "prnaccelv"。 漫游者动力学与 "移动基地 "模式不兼容，所以在使用该模式时要将其关闭。

**pos1-posopt1 = off, on (Sat PCV)**

设置是否使用卫星天线的相位中心变化。对于 RTK 来说，让它关闭，但对于PPP来说，你设置它。如果设置为开，你需要在文件参数中指定卫星天线PCV文件。

**pos1-posopt2 = off, on (Rec PCV)**

设置是否使用接收机天线的相位中心变化。如果设置为开，你需要在文件参数中指定接收机天线PCV文件，并在天线部分指定基地和漫游者的接收机天线类型。在IGS提供的天线文件中只包括测量级天线，所以只有当你的天线在文件中时才使用这个功能。它主要影响Z轴的精度，所以如果你关心高度，它可能很重要。如果两根天线都是一样的，你可以不使用这个，因为它们会被抵消。

**pos1-posopt5 = off, on (RAIM FDE)**

如果任何卫星的残差超过一个阈值，该卫星就会被排除，然后重新计算。这将只排除误差非常大的卫星，但需要相当多的计算，所以我通常把它关闭。

**pos1-exclsats=**

如果你知道某颗卫星是坏的，你可以在这里列出它，将它排除在解决方案之外。我只在极少数情况下，如果我怀疑某个卫星是坏的，才会使用这个方法进行调试。

**pos1-navsys = 7, 15,**

我总是包括GLONASS和SBAS卫星，因为更多的信息通常是更好的。 如果使用较新的3.0 u-blox固件和M8T，我也会启用伽利略。

### SETTING 2

**pos2-armode = continuous, fix-and-hold**

 整数模糊性的解决方法。"Continuous  "模式不利用固定值来调整相位偏置状态，所以它对错误的固定值最有免疫力。 "Fix-and-hold "确实利用固定的反馈来帮助跟踪模糊状态。 我更喜欢使用 "固定-保持"，并将跟踪增益（pos2-varholdamb）调整得足够低，以尽量减少错误修复的机会。 如果 "armode "没有设置为 "fix-and-hold"，那么下面提到的任何关于保持的选项都不适用，包括pos2-gloarmode。

**pos2-varholdamb=0.001, 0.1 (meters)**

在 demo5 的代码中，固定和保持的跟踪增益可以通过这个参数来调整。它实际上是一个方差，而不是一个增益，所以较大的数值会带来较低的增益。0.001 是默认值，任何超过 100 的值都会有很小的影响。这个值被用作保持期间产生的伪距测量的方差，它提供反馈以驱动卡尔曼滤波器中的偏置状态向整数值发展。 我发现，从 0.1 到 1.0 的数值可以提供足够的增益来帮助固定，同时在大多数情况下仍然可以避免错误的固定。

**pos2-gloarmode = on,** **fix-and-hold,** **autocal**

GLONASS 卫星的整数模糊性分辨率。 如果您的接收机是相同的，您通常可以将其设置为 "开"，这是首选的设置，因为它将允许 GLONASS 卫星在初始获取过程中用于整数歧义的解决。如果您的接收机不同或者您使用两个 u-blox M8N 接收机，如果您想将 GLONASS 卫星纳入 AR 解决方案，您需要将此参数设置为 "fix-and-hold"，以消除频间偏差。在这种情况下，GLONASS 卫星将不会被用于解决模糊性问题，直到通道间偏置被校准后，即在第一次保持后开始。还有一个 "autocal "选项，但我一直无法在 2.4.3 代码中使其发挥作用。 在 demo5 的代码中，我为这个功能添加了预设初始通道间偏置、方差和校准增益的功能。 然后我将偏置设置为特定接收器对的已知值，并将增益设置得很低。 这使该功能的自动校准功能失效，但确实提供了一种指定偏置的机制，否则 RTKLIB中就没有这种机制。 当使用 "自动定位 "时，GLONASS 卫星将用于初始获取。 自动校准 "功能也可用于确定通道间的偏差，并使用迭代方法确定零或短基线。

**pos2-gainholdamb=0.01**

在demo5代码中，GLONASS卫星的频间偏差校正的增益可以通过这个参数来调整。

**pos2-arthres = 3**

这是用来确定对模糊性解决方法是否有足够的信心来宣布修复的阈值。它是次佳解的残差平方与最佳解的比率。一般来说，我总是把它放在默认值3.0，然后调整所有其他参数来解决这个问题。尽管较大的AR比值表明比低AR比值更有信心，但这两者之间并没有固定的关系。在给定的AR比率下，卡尔曼滤波器状态的误差越大，对该解决方案的信心就越低。一般来说，卡尔曼滤波的误差在它第一次收敛时最大，所以这时最有可能得到一个错误的修复。减少pos2-arthers1可以帮助避免这种情况。 

**pos2-arfilter = on**

将此设置为 "开 "将使新卫星或从周期性滑移中恢复的卫星合格。如果一个卫星在首次加入时明显降低了AR ratio值，那么它用于解决模糊性的时间将被推迟。打开这个选项应该允许你减少 "arlockcnt"，它有类似的目的，但有一个盲目的延迟计数。





















